<!DOCTYPE html>
<html>
<head>
    <title>3D Earth Globe</title>
    <style>
        body { 
            margin: 0;
            overflow: hidden;
            background-color: #000;
        }
        #info {
            position: absolute;
            top: 10px;
            left: 10px;
            color: white;
            font-family: Arial, sans-serif;
            font-size: 14px;
            background: rgba(0,0,0,0.7);
            padding: 10px;
            border-radius: 5px;
        }
        #controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            background: rgba(0,0,0,0.7);
            padding: 15px;
            border-radius: 10px;
        }
        .control-btn {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            transition: all 0.3s ease;
        }
        .control-btn:hover {
            background: #45a049;
            transform: scale(1.05);
        }
        .control-btn:active {
            transform: scale(0.95);
        }
        #start { background: #4CAF50; }
        #pause { background: #f44336; }
        #speedUp { background: #2196F3; }
        #speedDown { background: #ff9800; }
        
        .speed-display {
            color: white;
            margin: auto 0;
            padding: 0 15px;
            font-family: Arial, sans-serif;
        }
    </style>
</head>
<body>
    <div id="info">3D地球仪<br>使用鼠标拖动来旋转视角<br>使用滚轮缩放</div>
    
    <div id="controls">
        <button id="start" class="control-btn">开始</button>
        <button id="pause" class="control-btn">暂停</button>
        <button id="speedDown" class="control-btn">减速</button>
        <button id="speedUp" class="control-btn">加速</button>
        <div class="speed-display">速度: <span id="speedValue">1</span>x</div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script>
        let scene, camera, renderer, earth, earthGroup, controls;
        let autoRotate = true;
        let rotationSpeed = 0.002;
        let speedMultiplier = 1;
        const MAX_SPEED = 5;
        const MIN_SPEED = 0.2;
        const SPEED_STEP = 0.2;

        function init() {
            // 创建场景
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x000000);

            // 创建相机
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 3;

            // 创建渲染器
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            // 创建控制器
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.rotateSpeed = 0.5;
            controls.minDistance = 2;
            controls.maxDistance = 10;

            // 创建地球组
            earthGroup = new THREE.Group();
            earthGroup.rotation.z = -23.5 * Math.PI / 180;
            scene.add(earthGroup);

            // 创建地球
            const earthGeometry = new THREE.SphereGeometry(1, 64, 64);
            const earthTexture = new THREE.TextureLoader().load('https://threejs.org/examples/textures/planets/earth_atmos_2048.jpg');
            const earthMaterial = new THREE.MeshPhongMaterial({ 
                map: earthTexture,
                specular: new THREE.Color(0x333333),
                shininess: 5
            });
            earth = new THREE.Mesh(earthGeometry, earthMaterial);
            earthGroup.add(earth);

            // 创建地轴
            const axisLength = 2.5;
            const axisGeometry = new THREE.CylinderGeometry(0.01, 0.01, axisLength, 32);
            const axisMaterial = new THREE.MeshBasicMaterial({ color: 0xff0000 });
            const axis = new THREE.Mesh(axisGeometry, axisMaterial);
            axis.position.set(0, 0, 0);
            earthGroup.add(axis);

            // 创建赤道
            const equatorGeometry = new THREE.TorusGeometry(1, 0.005, 32, 100);
            const equatorMaterial = new THREE.MeshBasicMaterial({ color: 0xffff00 });
            const equator = new THREE.Mesh(equatorGeometry, equatorMaterial);
            equator.rotation.x = Math.PI / 2;
            earthGroup.add(equator);

            // 添加南北极点标记
            const poleGeometry = new THREE.SphereGeometry(0.03, 16, 16);
            const northPoleMaterial = new THREE.MeshBasicMaterial({ color: 0xff0000 });
            const southPoleMaterial = new THREE.MeshBasicMaterial({ color: 0x0000ff });
            
            // 北极点（红色）
            const northPole = new THREE.Mesh(poleGeometry, northPoleMaterial);
            northPole.position.y = 1;
            earthGroup.add(northPole);
            
            // 南极点（蓝色）
            const southPole = new THREE.Mesh(poleGeometry, southPoleMaterial);
            southPole.position.y = -1;
            earthGroup.add(southPole);

            // 添加光照
            const ambientLight = new THREE.AmbientLight(0x404040);
            scene.add(ambientLight);

            const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
            directionalLight.position.set(5, 3, 5);
            scene.add(directionalLight);

            // 添加星空背景
            createStars();

            // 初始化控制按钮
            initControls();

            // 添加事件监听
            controls.addEventListener('start', function() {
                if (!autoRotate) return;
                autoRotate = false;
                updateButtonStates();
            });

            window.addEventListener('resize', onWindowResize, false);
        }

        function createStars() {
            const starsGeometry = new THREE.BufferGeometry();
            const starsMaterial = new THREE.PointsMaterial({
                color: 0xFFFFFF,
                size: 0.05,
                sizeAttenuation: true
            });

            const starsVertices = [];
            for(let i = 0; i < 5000; i++) {
                const x = THREE.MathUtils.randFloatSpread(2000);
                const y = THREE.MathUtils.randFloatSpread(2000);
                const z = THREE.MathUtils.randFloatSpread(2000);
                starsVertices.push(x, y, z);
            }

            starsGeometry.setAttribute('position', 
                new THREE.Float32BufferAttribute(starsVertices, 3));
            
            const stars = new THREE.Points(starsGeometry, starsMaterial);
            scene.add(stars);
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function animate() {
            requestAnimationFrame(animate);

            // 更新控制器
            controls.update();

            // 地球自转（自西向东），考虑速度倍数
            if (autoRotate) {
                earth.rotation.y += rotationSpeed * speedMultiplier;
            }

            renderer.render(scene, camera);
        }

        // 添加控制按钮的事件监听
        function initControls() {
            const startBtn = document.getElementById('start');
            const pauseBtn = document.getElementById('pause');
            const speedUpBtn = document.getElementById('speedUp');
            const speedDownBtn = document.getElementById('speedDown');
            const speedDisplay = document.getElementById('speedValue');

            startBtn.addEventListener('click', () => {
                autoRotate = true;
                updateButtonStates();
            });

            pauseBtn.addEventListener('click', () => {
                autoRotate = false;
                updateButtonStates();
            });

            speedUpBtn.addEventListener('click', () => {
                if (speedMultiplier < MAX_SPEED) {
                    speedMultiplier += SPEED_STEP;
                    speedMultiplier = Math.min(MAX_SPEED, speedMultiplier);
                    updateSpeedDisplay();
                }
            });

            speedDownBtn.addEventListener('click', () => {
                if (speedMultiplier > MIN_SPEED) {
                    speedMultiplier -= SPEED_STEP;
                    speedMultiplier = Math.max(MIN_SPEED, speedMultiplier);
                    updateSpeedDisplay();
                }
            });

            // 更新按钮状态的函数
            function updateButtonStates() {
                startBtn.style.opacity = autoRotate ? '0.5' : '1';
                startBtn.disabled = autoRotate;
                pauseBtn.style.opacity = autoRotate ? '1' : '0.5';
                pauseBtn.disabled = !autoRotate;
            }

            // 更新速度显示
            function updateSpeedDisplay() {
                speedDisplay.textContent = speedMultiplier.toFixed(1);
            }

            // 初始化按钮状态
            updateButtonStates();
        }

        init();
        animate();
    </script>
</body>
</html>
