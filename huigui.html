<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>太阳直射点回归运动示意图</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 0;
            padding: 20px;
            background-color: #f0f8ff;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            position: relative;
        }
        
        .simulation-container {
            width: 750px;
            height: 400px;
            margin: 50px auto;
            position: relative;
            background-color: #000033;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .earth-container {
            width: 300px;
            height: 300px;
            position: absolute;
            left: 100px;
            top: 50px;
            border: 1px solid #333;
            border-radius: 50%;
            background-color: #3399ff;
            overflow: hidden;
        }
        
        .equator {
            position: absolute;
            width: 100%;
            height: 2px;
            background-color: #ff0000;
            top: 50%;
            z-index: 2;
        }
        
        .tropic-cancer {
            position: absolute;
            width: 100%;
            height: 1px;
            background-color: #ff6600;
            top: 26.5%;
            z-index: 2;
        }
        
        .tropic-capricorn {
            position: absolute;
            width: 100%;
            height: 1px;
            background-color: #ff6600;
            top: 73.5%;
            z-index: 2;
        }
        
        .sun {
            position: absolute;
        width: 60px;
        height: 60px;
        background-color: #ffff00;
        border-radius: 50%;
        box-shadow: 0 0 30px 10px rgba(255, 255, 0, 0.7);
        z-index: 3;
        right: 100px;
        transform: translate(50%, -50%);
        /* 新增文字样式 */
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        color: #ff6600;
        text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        
        .label {
            position: absolute;
            left: 25px;
            font-weight: bold;
            z-index: 3;
            color: white;
        }
        
        .sunlight {
            position: absolute;
            height: 6px;
            background-color: #ffff00 !important;
            z-index: 5;
            transform-origin: left center;
        }
        
        .sunray-container {
            position: absolute;
            z-index: 5;
            pointer-events: none;
        }
        
        .arrow {
            position: absolute;
            width: 0;
            height: 0;
            border-top: 6px solid transparent;
            border-bottom: 6px solid transparent;
            border-right: 12px solid rgba(255, 255, 0, 0.9);
            z-index: 3;
            transform-origin: center right;
        }
        
        .direct-ray-point {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #ff0000;
            border-radius: 50%;
            box-shadow: 0 0 5px 2px rgba(255, 0, 0, 0.7);
            z-index: 4;
        }
        
        .perpendicular-indicator {
            position: absolute;
            width: 16px;
            height: 16px;
            border-right: 2px solid #00ff00;
            border-bottom: 2px solid #00ff00;
            z-index: 4;
            transform: rotate(45deg);
            opacity: 0.8;
        }
        
        .control-panel {
            margin: 20px auto;
            padding: 10px;
            background-color: #e6f2ff;
            border-radius: 5px;
        }
        
        .date-display {
            font-size: 24px;
            font-weight: bold;
            margin: 10px 0;
            color: #333;
        }
        
        .info-panel {
            margin: 20px auto;
            padding: 15px;
            background-color: #e6f2ff;
            border-radius: 5px;
            text-align: left;
        }
        
        button {
            padding: 8px 15px;
            margin: 0 5px;
            border-radius: 4px;
            border: none;
            background-color: #4285f4;
            color: white;
            cursor: pointer;
        }
        
        button:hover {
            background-color: #3b78e7;
        }
        
        input[type="range"] {
            vertical-align: middle;
            margin: 0 10px;
        }
        
        .angle-display {
            position: absolute;
            color: white;
            font-size: 12px;
            font-weight: bold;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.7);
        }
        
        #sunRays {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 5;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>太阳直射点回归运动示意图</h1>
        
        <div class="date-display" id="dateDisplay">1月1日</div>
        
        <div class="simulation-container">
            <div class="earth-container" id="earthContainer">
                <div class="equator"></div>
                <div class="tropic-cancer"></div>
                <div class="tropic-capricorn"></div>
                
                <div class="label" style="top: 45%;">赤道</div>
                <div class="label" style="top: 21.5%;">北回归线</div>
                <div class="label" style="top: 68.5%;">南回归线</div>
            </div>
            
            <div class="sun" id="sun">太阳</div>
            <div id="sunRays"></div>
        </div>
        
        <div class="control-panel">
            <button id="playBtn">播放/暂停</button>
            <button id="resetBtn">重置</button>
        </div>
        
        <div class="info-panel">
            <h3>太阳直射点运动说明：</h3>
            <p>1. 太阳直射点全年在南北回归线之间移动</p>
            <p>2. 3月21日(春分)：太阳直射赤道，赤道正午太阳高度角为90°</p>
            <p>3. 6月22日(夏至)：太阳直射北回归线，北回归线正午太阳高度角为90°</p>
            <p>4. 9月23日(秋分)：太阳直射赤道，赤道正午太阳高度角为90°</p>
            <p>5. 12月22日(冬至)：太阳直射南回归线，南回归线正午太阳高度角为90°</p>
            <p>直射点处的太阳光线与地球表面垂直（太阳高度角为90°），箭头表示太阳光线照射方向，红点表示太阳直射点。</p>
        </div>
    </div>

    <script>
        const sun = document.getElementById('sun');
        const dateDisplay = document.getElementById('dateDisplay');
        const playBtn = document.getElementById('playBtn');
        const resetBtn = document.getElementById('resetBtn');
        const sunRays = document.getElementById('sunRays');
        const earthContainer = document.getElementById('earthContainer');
        
        let isPlaying = false;
        let startTime = null;
        const CYCLE_DURATION = 30000; // 30秒，以毫秒为单位
        let day = 0;
        
        // 地球参数
        const earthTop = 50;
        const earthHeight = 300;
        const earthLeft = 100;
        const earthWidth = 300;
        const earthCenterX = earthLeft + earthWidth/2;
        const earthCenterY = earthTop + earthHeight/2;
        const earthRadius = earthWidth/2;
        
        const equatorPosition = earthTop + earthHeight/2; // 赤道位置
        const tropicCancerPosition = earthTop + earthHeight * 0.265; // 北回归线位置
        const tropicCapricornPosition = earthTop + earthHeight * 0.735; // 南回归线位置
        
        // 太阳参数
        const sunX = 650; // 太阳右侧位置
        
        // 修改 updateSunPosition 函数
        function updateSunPosition(currentTime) {
            const maxDays = 365;
            
            if (!startTime && isPlaying) {
                startTime = currentTime;
            }
            
            if (isPlaying && startTime) {
                const elapsedTime = currentTime - startTime;
                const cycleProgress = (elapsedTime % CYCLE_DURATION) / CYCLE_DURATION;
                day = Math.floor(maxDays * cycleProgress);
            }

            const equatorY = (tropicCapricornPosition + tropicCancerPosition) / 2; // 赤道位置
            let directRayEarthY;

            // 修正时间段划分
            // 冬至(12/22) -> 春分(3/21): 约90天
            // 春分(3/21) -> 夏至(6/22): 约93天
            // 夏至(6/22) -> 秋分(9/23): 约93天
            // 秋分(9/23) -> 冬至(12/22): 约89天
            
            if (day <= 90) { // 冬至到春分 (12/22 - 3/21)
                const progress = day / 90;
                directRayEarthY = tropicCapricornPosition - (tropicCapricornPosition - equatorY) * progress;
            } 
            else if (day <= 183) { // 春分到夏至 (3/21 - 6/22)
                const progress = (day - 90) / 93;
                directRayEarthY = equatorY - (equatorY - tropicCancerPosition) * progress;
            }
            else if (day <= 276) { // 夏至到秋分 (6/22 - 9/23)
                const progress = (day - 183) / 93;
                directRayEarthY = tropicCancerPosition + (equatorY - tropicCancerPosition) * progress;
            }
            else { // 秋分到冬至 (9/23 - 12/22)
                const progress = (day - 276) / 89;
                directRayEarthY = equatorY + (tropicCapricornPosition - equatorY) * progress;
            }

            sun.style.top = directRayEarthY + 'px';
            sunRays.innerHTML = '';
            createSunRays(directRayEarthY);
            updateDateDisplay();
        }
        
        // 修改 createSunRays 函数
        function createSunRays(directRayEarthY) {
            // 清除现有的光线
            sunRays.innerHTML = '';
            
            // 计算直射点在地球上的位置
            const relativeY = directRayEarthY - earthCenterY;
            const surfaceX = Math.sqrt(earthRadius * earthRadius - relativeY * relativeY);
            const directRayEarthX = earthCenterX + surfaceX;
            
            // 创建从太阳到直射点的水平光线
            const sunToDirectContainer = document.createElement('div');
            sunToDirectContainer.className = 'sunray-container';
            
            // 设置光线起点（从太阳右侧开始）
            const sunRightX = sunX - 60; // 从太阳的左边缘开始
            const sunCenterY = directRayEarthY;
            
            // 设置容器位置
            sunToDirectContainer.style.position = 'absolute';
            sunToDirectContainer.style.left = directRayEarthX + 'px'; // 从直射点开始
            sunToDirectContainer.style.top = sunCenterY - 3 + 'px'; // 居中对齐
            
            // 计算光线长度
            const rayLength = sunRightX - directRayEarthX;
            
            // 创建水平光线
            const sunRay = document.createElement('div');
            sunRay.className = 'sunlight';
            sunRay.style.width = Math.abs(rayLength) + 'px'; // 使用绝对值确保长度为正
            sunRay.style.backgroundColor = '#ffff00';
            sunRay.style.boxShadow = '0 0 10px 3px rgba(255, 255, 0, 0.7)';
            sunRay.style.opacity = '1';
            
            // 添加渐变效果
            sunRay.style.background = 'linear-gradient(to right, rgba(255, 255, 0, 1), rgba(255, 255, 0, 0.8))';
            
            sunToDirectContainer.appendChild(sunRay);
            
            // 创建直射点红点
            const directPoint = document.createElement('div');
            directPoint.className = 'direct-ray-point';
            directPoint.style.position = 'absolute';
            directPoint.style.left = '-6px';
            directPoint.style.top = '-3px';
            directPoint.style.width = '12px';
            directPoint.style.height = '12px';
            directPoint.style.backgroundColor = '#ff0000';
            directPoint.style.borderRadius = '50%';
            directPoint.style.boxShadow = '0 0 10px 3px rgba(255, 0, 0, 0.7)';
            directPoint.style.zIndex = '6';
            
            sunToDirectContainer.appendChild(directPoint);
            
            // 将光线添加到场景中
            sunRays.appendChild(sunToDirectContainer);
        }
        
        // 修改 updateDateDisplay 函数
        function updateDateDisplay() {
            const months = [
                '1月', '2月', '3月', '4月', '5月', '6月', 
                '7月', '8月', '9月', '10月', '11月', '12月'
            ];
            
            let monthDay;
            let specialDay = '';
            
            // 修正日期计算
            if (day <= 90) { // 冬至到春分
                if (day === 0) {
                    monthDay = { month: 12, day: 22 }; // 冬至
                    specialDay = '（冬至）';
                } else {
                    monthDay = calculateDate(day, 12, 22);
                }
                if (day === 90) {
                    monthDay = { month: 3, day: 21 }; // 春分
                    specialDay = '（春分）';
                }
            }
            else if (day <= 183) { // 春分到夏至
                if (day === 183) {
                    monthDay = { month: 6, day: 22 }; // 夏至
                    specialDay = '（夏至）';
                } else {
                    monthDay = calculateDate(day - 90, 3, 21);
                }
            }
            else if (day <= 276) { // 夏至到秋分
                if (day === 276) {
                    monthDay = { month: 9, day: 23 }; // 秋分
                    specialDay = '（秋分）';
                } else {
                    monthDay = calculateDate(day - 183, 6, 22);
                }
            }
            else { // 秋分到冬至
                if (day === 365) {
                    monthDay = { month: 12, day: 22 }; // 回到冬至
                    specialDay = '（冬至）';
                } else {
                    monthDay = calculateDate(day - 276, 9, 23);
                }
            }
            
            dateDisplay.textContent = `${months[monthDay.month-1]}${monthDay.day}日 ${specialDay}`;
        }
        
        // 辅助函数：计算具体日期
        function calculateDate(daysPassed, startMonth, startDay) {
            const daysInMonth = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
            let month = startMonth;
            let day = startDay;
            
            let remainingDays = daysPassed;
            while (remainingDays > 0) {
                const daysInCurrentMonth = daysInMonth[(month - 1) % 12];
                if (remainingDays + day > daysInCurrentMonth) {
                    remainingDays -= (daysInCurrentMonth - day + 1);
                    month = (month % 12) + 1;
                    day = 1;
                } else {
                    day += remainingDays;
                    remainingDays = 0;
                }
            }
            
            return { month, day };
        }
        
        // 修改动画循环函数
        function animate(currentTime) {
            if (isPlaying) {
                updateSunPosition(currentTime);
            }
            requestAnimationFrame(animate);
        }
        
        // 修改播放按钮事件处理
        playBtn.addEventListener('click', function() {
            isPlaying = !isPlaying;
            if (isPlaying) {
                startTime = null; // 重置开始时间
                this.textContent = '暂停';
            } else {
                this.textContent = '播放';
            }
        });
        
        // 修改重置按钮事件处理
        resetBtn.addEventListener('click', function() {
            isPlaying = false;
            playBtn.textContent = '播放';
            startTime = null;
            day = 0;
            updateSunPosition(0);
        });
        
        // 初始化
        animate(0); // 启动动画循环
        day = 0; // 从冬至开始（12月22日）
        updateSunPosition(0); // 初始化位置

        // 禁止右键菜单
        document.oncontextmenu = function(e) {
            e.preventDefault();
            return false;
        };

     

        // 禁止键盘快捷键
        document.onkeydown = function(e) {
            // 禁止 Ctrl + C
            if (e.ctrlKey && e.keyCode === 67) {
                e.preventDefault();
                return false;
            }
            // 禁止 Ctrl + U（查看源代码）
            if (e.ctrlKey && e.keyCode === 85) {
                e.preventDefault();
                return false;
            }
            // 禁止 F12
            if (e.keyCode === 123) {
                e.preventDefault();
                return false;
            }
        };
    </script>
</body>
</html>